<view class="container">

  <!-- 1. 岗位名称 + 2. 工作时间 -->
  <view class="zw-header">
    <view class="zw-title">{{jobinfo.jobtitle}}</view>
    <!-- 新字段时间优先 -->
    <view class="zw-time" wx:if="{{jobinfo.work_start_date || jobinfo.work_end_date}}">
      <text class="fa fa-calendar"></text>
      <text>{{jobinfo.work_start_date}} - {{jobinfo.work_end_date}}</text>
    </view>
    <!-- 老字段时间降级（时间戳已格式化） -->
    <view class="zw-time" wx:elif="{{jobinfo.createtime_fmt || jobinfo.endtime_fmt}}">
      <text class="fa fa-calendar"></text>
      <text>{{jobinfo.createtime_fmt}} - {{jobinfo.endtime_fmt ? jobinfo.endtime_fmt : '长期有效'}}</text>
    </view>
    <view class="zw-time" wx:if="{{jobinfo.work_start_time || jobinfo.work_end_time}}">
      <text class="fa fa-clock-o"></text>
      <text>{{jobinfo.work_start_time}} - {{jobinfo.work_end_time}}</text>
    </view>
  </view>

  <!-- 3. 行业 + 4. 工资结算方式 + 5. 男女限制情况 -->
  <view class="zw-tags">
    <view class="zw-tag" wx:if="{{jobinfo.industry}}">{{jobinfo.industry}}</view>
    <view class="zw-tag">{{jobinfo.settle_text}}</view>
    <view class="zw-tag">{{jobinfo.sex_text}}</view>
  </view>

  <!-- 6. 工时(x元/小时) + 7. 需要人数 -->
  <view class="zw-price-row">
    <view class="zw-price">
      <text class="zw-price-num">{{jobinfo.price_text}}</text>
      <text class="zw-price-unit" wx:if="{{jobinfo.price_unit}}">{{jobinfo.price_unit}}</text>
    </view>
    <view class="zw-headcount" wx:if="{{jobinfo.num}}">需要{{jobinfo.num}}人</view>
  </view>

  <!-- 福利标签（若有） -->
  <view class="zw-benefits" wx:if="{{jobinfo.benefit_tag1 || jobinfo.benefit_tag2 || (jobinfo.special && jobinfo.special.length > 0 && jobinfo.special[0])}}">
    <view class="zw-benefit-tag highlight" wx:if="{{jobinfo.benefit_tag1}}">{{jobinfo.benefit_tag1}}</view>
    <view class="zw-benefit-tag highlight" wx:if="{{jobinfo.benefit_tag2}}">{{jobinfo.benefit_tag2}}</view>
    <view class="zw-benefit-tag" wx:for="{{jobinfo.special}}" wx:key="index" wx:if="{{item}}">{{item}}</view>
  </view>

  <!-- 职位说明（基本信息） -->
  <view class="zw-section" wx:if="{{jobinfo.education || jobinfo.age || jobinfo.express}}">
    <view class="zw-section-title">职位说明</view>
    <view class="zw-job-fields">
      <view class="zw-job-field" wx:if="{{jobinfo.num}}"><text class="zw-field-label">招聘：</text><text>{{jobinfo.num}}人</text></view>
      <view class="zw-job-field" wx:if="{{jobinfo.age}}"><text class="zw-field-label">年龄：</text><text>{{jobinfo.age}}</text></view>
      <view class="zw-job-field"><text class="zw-field-label">性别：</text><text>{{jobinfo.sex_text}}</text></view>
      <view class="zw-job-field" wx:if="{{jobinfo.education}}"><text class="zw-field-label">学历：</text><text>{{jobinfo.education}}</text></view>
      <view class="zw-job-field" wx:if="{{jobinfo.express}}"><text class="zw-field-label">经验：</text><text>{{jobinfo.express}}</text></view>
    </view>
  </view>

  <!-- 8. 工作地点描述 + 9. 工作地点地图 -->
  <view class="zw-section" wx:if="{{jobinfo.job_address}}">
    <view class="zw-section-title">工作地点</view>
    <view class="zw-address" bindtap="goMap">
      <text class="fa fa-map-marker" style="color:#fe552e;margin-right:10rpx;"></text>
      <text>{{jobinfo.job_address}}</text>
    </view>
    <view class="zw-map" wx:if="{{hasMap}}" bindtap="goMap">
      <map id="map" longitude="{{mapLng}}" latitude="{{mapLat}}" scale="14" markers="{{markers}}" style="width:100%;height:300rpx;"></map>
    </view>
  </view>

  <!-- 10. 工作内容描述 -->
  <view class="zw-section" wx:if="{{jobinfo.content}}">
    <view class="zw-section-title">工作内容</view>
    <view class="zw-content">
      <rich-text nodes="{{jobinfo.content}}"></rich-text>
    </view>
  </view>

  <!-- 11. 工作要求描述 -->
  <view class="zw-section" wx:if="{{jobinfo.requirements}}">
    <view class="zw-section-title">工作要求</view>
    <view class="zw-content">
      <rich-text nodes="{{jobinfo.requirements}}"></rich-text>
    </view>
  </view>

  <!-- 12. 发布者信息 -->
  <view class="zw-publisher">
    <view class="zw-publisher-avatar">
      <image src="{{publisherinfo.thumb}}" mode="aspectFill" wx:if="{{publisherinfo.thumb}}"></image>
      <view class="zw-avatar-placeholder" wx:else>
        <text class="fa fa-user"></text>
      </view>
    </view>
    <view class="zw-publisher-detail">
      <view class="zw-publisher-row1">
        <text class="zw-publisher-name">{{publisherinfo.mastername || publisherinfo.companyname || jobinfo.companyinfo.companyname || '发布者'}}</text>
        <text class="zw-verified" wx:if="{{publisherinfo.is_verified == 1}}">已实名</text>
      </view>
      <view class="zw-publisher-row2" wx:if="{{jobinfo.companyinfo.companyname}}">
        <text>{{jobinfo.companyinfo.companyname}}</text>
        <text wx:if="{{jobinfo.companyinfo.companytype}}"> · {{jobinfo.companyinfo.companytype}}</text>
      </view>
    </view>
  </view>

  <!-- 安全提示 -->
  <view class="zw-safety">
    <text class="fa fa-exclamation-triangle" style="color:#ff9102;margin-right:10rpx;"></text>
    <text>安全提示：面试过程中，用人单位如收取费用均有诈骗嫌疑，请提高警惕。如遇无效、虚假、诈骗信息，请及时举报。</text>
  </view>

</view>

<!-- Sticky Bottom Bar -->
<view class="zw-bottom-space"></view>
<view class="zw-bottom-bar">
  <view class="zw-bottom-btn zw-btn-share">
    <button open-type="share" class="zw-share-btn"><text class="fa fa-share-alt"></text><text class="zw-btn-label">分享</text></button>
  </view>
  <view class="zw-bottom-btn zw-btn-save {{savestatus == 1 ? 'zw-saved' : ''}}" bindtap="doSavejob">
    <text class="fa fa-heart{{savestatus == 1 ? '' : '-o'}}"></text>
    <text class="zw-btn-label">收藏</text>
  </view>
  <view class="zw-bottom-btn zw-btn-apply" bindtap="doSendjob" wx:if="{{userRole != 2}}">
    <text>报名</text>
    <text class="zw-apply-count" wx:if="{{apply_count > 0}}">（{{apply_count}}人已报名）</text>
  </view>
</view>
